@model IEnumerable<DSAA.EntityFrameworkCore.Entity.User>

@{
    ViewData["Title"] = "用户角色维护";
}


<div class="">
    <div class="page-header-title">
        <h4 class="page-title">@ViewData["Title"] </h4>
    </div>
</div>





<!-- DataTables -->
<link href="~/assets/plugins/datatables/jquery.dataTables.min.css" rel="stylesheet" type="text/css" />
<link href="~/assets/plugins/datatables/buttons.bootstrap.min.css" rel="stylesheet" type="text/css" />
<link href="~/assets/plugins/datatables/fixedHeader.bootstrap.min.css" rel="stylesheet" type="text/css" />
<link href="~/assets/plugins/datatables/responsive.bootstrap.min.css" rel="stylesheet" type="text/css" />
<link href="~/assets/plugins/datatables/dataTables.bootstrap.min.css" rel="stylesheet" type="text/css" />
<link href="~/assets/plugins/datatables/scroller.bootstrap.min.css" rel="stylesheet" type="text/css" />



<div class="page-content-wrapper ">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="panel panel-default">
                    <div class="panel-body">

                        <div class="row">
                            <div class="col-md-12">

                                <div class="panel panel-primary">
                                    <div class="panel-body">
                                        <address>
                                            1. 您可以在本页搜索、查看用户及对用户设置权限和密码。<br />
                                            2. 可以对用户的密码和组进行更改。
                                        </address>
                                    </div> <!-- panel-body -->
                                </div> <!-- panel -->

                                <div class="panel-body">
                                    <div class="row">
                                        <div class="col-md-12 col-sm-12 col-xs-12">
                                            <table id="datatable" class="table table-striped table-bordered text-center">
                                                <thead>
                                                    <tr>
                                                        <td>用户ID</td>
                                                        <td>用户名</td>
                                                        <td>昵称</td>
                                                        <td>通过数</td>
                                                        <td>注册时间</td>
                                                        <td>用户组</td>
                                                        <td>编辑</td>
                                                        <td>删除</td>
                                                    </tr>
                                                </thead>


                                                <tbody>
                                                    @foreach (var item in Model)
                                                    {
                                                        <tr>
                                                            <td>
                                                                @Html.DisplayFor(modelItem => item.Id)
                                                            </td>
                                                            <td>
                                                                @Html.DisplayFor(modelItem => item.UserName)
                                                            </td>
                                                            <td>
                                                                @Html.DisplayFor(modelItem => item.NickName)
                                                            </td>
                                                            <td>

                                                                @item.Ratio.ToString("F2")%
                                                                (@item.SolvedCount.ToString()/@item.SubmitCount.ToString())

                                                            </td>
                                                            <td>
                                                                @Html.DisplayFor(modelItem => item.CreateDate)
                                                            </td>

                                                            <td>
                                                                @if (item.Group != null)
                                                                {
                                                                    @item.Group.GroupName
                                                                }
                                                                else
                                                                {
                                                                    <span>学生</span>
                                                                }
                                                            </td>
                                                            <td>
                                                                <a asp-area="Administrator" asp-controller="User" asp-action="Add" asp-route-id="@item.Id" class="waves-effect">
                                                                    <button type="button" class="btn btn-warning waves-effect waves-ligh">编辑</button>
                                                                </a>
                                                            </td>
                                                            <td>
                                                                <button type="button" class="btn btn-danger waves-effect waves-ligh" onclick="deletes(@item.Id,this)">删除</button>
                                                            </td>
                                                        </tr>
                                                    }

                                                </tbody>
                                            </table>

                                        </div>
                                    </div>


                                </div> <!-- panel-body -->
                            </div>
                        </div> <!-- end row -->
                    </div> <!-- panel body -->
                </div> <!-- end panel -->

            </div> <!-- end col -->

        </div>
        <!-- end row -->


    </div><!-- container -->
</div> <!-- Page content Wrapper -->
<!-- Datatables-->
<script src="~/assets/plugins/datatables/jquery.dataTables.min.js"></script>
<script src="~/assets/plugins/datatables/dataTables.bootstrap.js"></script>
<script src="~/assets/plugins/datatables/dataTables.buttons.min.js"></script>
<script src="~/assets/plugins/datatables/buttons.bootstrap.min.js"></script>
<script src="~/assets/plugins/datatables/jszip.min.js"></script>
<script src="~/assets/plugins/datatables/pdfmake.min.js"></script>
<script src="~/assets/plugins/datatables/vfs_fonts.js"></script>
<script src="~/assets/plugins/datatables/buttons.html5.min.js"></script>
<script src="~/assets/plugins/datatables/buttons.print.min.js"></script>
<script src="~/assets/plugins/datatables/dataTables.fixedHeader.min.js"></script>
<script src="~/assets/plugins/datatables/dataTables.keyTable.min.js"></script>
<script src="~/assets/plugins/datatables/dataTables.responsive.min.js"></script>
<script src="~/assets/plugins/datatables/responsive.bootstrap.min.js"></script>
<script src="~/assets/plugins/datatables/dataTables.scroller.min.js"></script>


<script>

    function urlto(url) {
        window.location.href = url;
    }
    function eddata(url) {
        swal({
            title: "操作确认",
            text: "删除后，您将无法恢复此题目！",
            icon: "warning",
            buttons: true,
            dangerMode: true,
        })
            .then((willDelete) => {
                if (willDelete) {
                    $.ajax({
                        url: url,
                        type: "post",
                        success: function (response) {
                            var rs = JSON.stringify(response);
                            if (response == null)
                                swal("操作成功！", {
                                    icon: "success",
                                });
                            else
                                swal(rs, {
                                    icon: "error",
                                });
                        }
                    });

                }
            });
    }
    function deletes(id, obj) {
        swal({
            title: "操作确认",
            text: "删除后，您将无法恢复此分类！",
            icon: "warning",
            buttons: true,
            dangerMode: true,
        })
            .then((willDelete) => {
                if (willDelete) {
                    $.ajax({
                        url: "/Administrator/User/Delete/" + id,
                        type: "post",
                        success: function (response) {
                            if (response == "1") {
                                $(obj).parent().parent().remove();
                                swal("删除成功！", {
                                    icon: "success",
                                });
                            } else
                                swal("删除失败！", {
                                    icon: "error",
                                });
                        }
                    });

                }
            });
    }
</script>

<script>

    !function ($) {
        var DataTable = function () {
            this.$dataTableButtons = $("#datatable-buttons")
        };
        DataTable.prototype.createDataTableButtons = function () {
            0 !== this.$dataTableButtons.length && this.$dataTableButtons.DataTable({
                dom: "Bfrtip",
                buttons: [{
                    extend: "copy",
                    className: "btn-success"
                }, {
                    extend: "csv"
                }, {
                    extend: "excel"
                }, {
                    extend: "pdf"
                }, {
                    extend: "print"
                }],
                responsive: !0
            });
        },
            DataTable.prototype.init = function () {

                $('#datatable').dataTable();

                $('#datatable-keytable').DataTable({ keys: true });
                $('#datatable-responsive').DataTable();
                $('#datatable-scroller').DataTable({
                    ajax: "assets/plugins/datatables/json/scroller-demo.json",
                    deferRender: true,
                    scrollY: 380,
                    scrollCollapse: true,
                    scroller: true
                });
                var table = $('#datatable-fixed-header').DataTable({ fixedHeader: true });

                //creating table with button
                this.createDataTableButtons();
            },
            //init
            $.DataTable = new DataTable, $.DataTable.Constructor = DataTable
    }(window.jQuery),

        //initializing
        function ($) {
            $.DataTable.init();
        }(window.jQuery);

</script>
